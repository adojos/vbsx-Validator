<html>
<head>
<title>Validate XML</title>
<HTA:APPLICATION
  APPLICATIONNAME="My HTML application"
  ID="MyHTMLapplication"
  VERSION="1.0"/>
</head>

<script language="VBScript">
'Dim input
Dim inputxsdns
Dim xml
Dim xsd
Sub Window_OnLoad
  
End Sub
Sub OnClickButtonselectXML()
  Call ChooseFile( )
  
End Sub
Sub OnClickButtonselectXSD()
 call ChooseFile1()
 
End Sub
Sub OnClickButtonnamespace()
  inputxsdns = InputBox("NameSpace of XSD file entered : ", "Enter XSD namespace URI")
End Sub

Sub OnClickButtonvalidatexml()
 Call LoadXMLDocument(xml,xsd, inputxsdns)
End Sub


 Function ChooseFile( )
' Select File dialog based on a script by Mayayana
' Known issues:
' * Tree view always opens Desktop folder
' * In Win7/IE8 only the file NAME is returned correctly, the path returned will always be C:\fakepath\
' * If a shortcut to a file is selected, the name of that FILE will be returned, not the shortcut's
    On Error Resume Next
    Dim objIE, strSelected
   ChooseFile = ""
    Set objIE = CreateObject( "InternetExplorer.Application" )
    objIE.visible = False
    objIE.Navigate( "about:blank" )
    Do Until objIE.ReadyState = 4
    Loop
    objIE.Document.Write "<HTML><BODY><INPUT ID=""FileSelect"" NAME=""FileSelect"" TYPE=""file""><BODY></HTML>"
   
    With objIE.Document.all.FileSelect
        .focus
        .click
        strSelected = .value
    End With
    objIE.Quit
    Set objIE = Nothing
    ChooseFile = strSelected
    xml = ChooseFile   
End Function

 Function ChooseFile1( )
' Select File dialog based on a script by Mayayana
' Known issues:
' * Tree view always opens Desktop folder
' * In Win7/IE8 only the file NAME is returned correctly, the path returned will always be C:\fakepath\
' * If a shortcut to a file is selected, the name of that FILE will be returned, not the shortcut's
    On Error Resume Next
    Dim objIE1, strSelected1
    ChooseFile1 = ""
    Set objIE1 = CreateObject( "InternetExplorer.Application" )
    objIE1.visible = False
    objIE1.Navigate( "about:blank" )
    Do Until objIE1.ReadyState = 4
    Loop
    objIE1.Document.Write "<HTML><BODY><INPUT ID=""FileSelect"" NAME=""FileSelect"" TYPE=""file""><BODY></HTML>"
   
    With objIE1.Document.all.FileSelect
        .focus
        .click
        strSelected1 = .value
    End With
    objIE1.Quit
    Set objIE1 = Nothing
    ChooseFile1 = strSelected1
   xsd = ChooseFile1   
End Function

Function FileExists(filename)
 Dim objFSO2
 
 'Create Object for FileSystem
 Set objFSO2 = CreateObject("Scripting.FileSystemObject")
 
 'Verify the specified file exists
 If objFSO2.FileExists(filename) Then
  FileExists = True
 Else 
  FileExists = False
 End If
 
 Set objFSO2 = Nothing
End Function

Function LoadXMLDocument(fileName, xsd, xsdns)
 Dim objDOM, objSchema, loadStatus
Dim xmlParseErr, objXMLDocSchemaCache, xmlXSDError
 
 'Create Object for MSXML
 Set objDOM = CreateObject("MSXML2.DOMDocument.6.0") 
 Set objXMLDocSchemaCache = CreateObject("Msxml2.XMLSchemaCache.6.0")
 
 'Add the XSD file to SchemCache object
 objXMLDocSchemaCache.add xsdns, xsd 
 
 'Set the DOM variables
 objDOM.async = False
 objDOM.validateOnParse = True
 objDOM.resolveExternals = True
 
 'Set the loaded XSD to DOM and load XML to DOM
 Set objDOM.schemas = objXMLDocSchemaCache 
 loadStatus = objDOM.Load(fileName) 
 Set xmlParseErr = objDOM.parseError
 
 'verify that XML is validated aganist Schema and loaded successfully
 If xmlParseErr.errorCode <> 0 Then
  Msgbox  xmlParseErr.reason, vbCritical
 Else  
  Set xmlXSDError = objDOM.validate
  If xmlXSDError.errorCode <> 0 Then
   MsgBox xmlXSDError.reason, vbCritical
  Else
   Msgbox "Successfully validated the XML aganist XSD", vbInformation 
  End If
 End If
 
 Set objDOM = Nothing
 Set objXMLDocSchemaCache = Nothing
End Function


</script>
<div >
<body bgcolor="pink">
<div align="center">
VBSX_Validator_v1.1.2<br>
&nbsp;&nbsp;&nbsp;&nbsp;   November 2013<br>
 Copyright (c) Tushar Sharma | www.testoxide.com

</div>
<div align="center"><h3>Validate your XML file against XSD based on XSD Schema</h3></div>



<input type="button" name="selectXML" id="selectXML" value="Select XML file" onclick="OnClickButtonselectXML"><br><br>

<input type="button" name="selectXSD" id="selectXSD" value="select XSD file" onclick="OnClickButtonselectXSD"><br><br>

<input type="button" name="namespace" id="namespace" value="Schema of XSD" onclick="OnClickButtonnamespace"><br><br>

<center><input type="button" name="validatexml" id="validatexml" value="Validate" onclick="OnClickButtonvalidatexml"></center>
<div align="right"><a href="D:\testoxide\vbsx\trunk\docs\help\load_validateXML help.pdf"><b>Help</b></a></div>


</body>
<div>
</html>